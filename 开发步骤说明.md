# 气运修仙游戏开发步骤说明

## 开发阶段规划

### 第一阶段：基础架构搭建 (1-2周)
**目标：建立项目基础框架，实现最基本的登录注册功能**

#### 步骤1：共享模块开发 (1-2天) ✅ 已完成
- [x] 完善 `shared/constants.py` - 定义游戏基础常量
- [x] 完善 `shared/schemas.py` - 定义数据传输模型
- [x] 新增 `shared/utils.py` - 共享工具函数
- [x] 优化属性系统 - 7个核心属性：生命值、物攻、法攻、物防、法防、暴击率、暴击倍数
- [x] 实现装备品质波动系统 - 同品质装备属性在范围内随机波动
- [x] 移除装备强化系统 - 用品质内波动控制装备强度差异
- [x] 移除角色等级系统 - 只保留境界系统
- [x] 完善所有境界数据 - 33个境界的完整修为需求和战斗属性
- [x] 移除装备耐久度和修理系统
- [x] 移除气运衰减 - 改为每日随机气运
- [x] 更新装备部位 - 移除戒指项链，新增法宝
- [x] 优化挂机系统 - 可选择修习方向，同时获得修为和基础属性

#### 步骤2：服务端基础架构 (2-3天) ✅ 已完成
- [x] 配置 `server/config.py` - 数据库连接等配置
- [x] 实现 `server/database/database.py` - 数据库连接管理
- [x] 实现 `server/database/models.py` - 用户、角色等基础数据模型
- [x] 实现 `server/database/crud.py` - 基础CRUD操作
- [x] 实现 `server/main.py` - FastAPI应用启动

#### 步骤3：用户认证系统 (2-3天) ✅ 已完成
- [x] 实现 `server/api/v1/auth.py` - 注册、登录接口
- [x] 实现 `server/api/v1/user.py` - 用户信息管理接口
- [x] 实现JWT token认证机制

#### 步骤4：客户端基础框架 (2-3天)✅ 已完成
- [ ] 实现 `client/network/api_client.py` - HTTP请求封装
- [ ] 实现 `client/state_manager.py` - 客户端状态管理
- [ ] 实现 `client/ui/login_window.py` - 登录注册界面
- [ ] 实现 `client/main.py` - 客户端启动入口

### 第二阶段：核心游戏系统 (2-3周)
**目标：实现修炼、气运等核心游戏机制**

#### 步骤5：游戏数据模型扩展 (2-3天)
- [ ] 扩展数据模型：角色属性、物品、装备等
- [ ] 实现用户角色数据自动创建和基础属性系统（每个用户只有一个角色）

#### 步骤6：气运系统实现 (3-4天)
- [ ] 实现 `server/core/systems/luck_system.py` - 气运核心逻辑
- [ ] 实现每日签到、气运影响机制
- [ ] 实现转运丹等道具系统

#### 步骤7：修炼系统实现 (3-4天)
- [ ] 实现 `server/core/systems/cultivation_system.py` - 修炼逻辑
- [ ] 实现挂机修炼、境界突破系统
- [ ] 实现 `server/core/game_loop.py` - 游戏主循环

#### 步骤8：主界面开发 (2-3天)
- [ ] 实现 `client/ui/main_window.py` - 主界面框架
- [ ] 实现 `client/ui/widgets/character_info_widget.py` - 角色信息面板
- [ ] 实现基础的界面布局和数据显示

### 第三阶段：功能模块完善 (3-4周)
**目标：实现背包、洞府、农场等功能模块**

#### 步骤9：背包系统 (3-4天)
- [ ] 实现物品、装备数据模型
- [ ] 实现 `client/ui/windows/backpack_window.py` - 背包界面
- [ ] 实现物品使用、装备穿戴逻辑

#### 步骤10：洞府系统 (4-5天)
- [ ] 实现 `client/ui/windows/cave_window.py` - 洞府界面
- [ ] 实现洞府升级、聚灵阵等功能
- [ ] 实现突破境界功能

#### 步骤11：农场系统 (4-5天)
- [ ] 实现 `server/core/systems/farm_system.py` - 农场逻辑
- [ ] 实现种植、收获、作物变异机制
- [ ] 实现农场界面（可集成到洞府或独立窗口）

#### 步骤12：炼丹系统 (4-5天)
- [ ] 实现 `server/core/systems/alchemy_system.py` - 炼丹逻辑
- [ ] 实现丹方、材料、炼制过程
- [ ] 实现炼丹界面和火候小游戏

### 第四阶段：高级功能 (2-3周)
**目标：实现副本、交易、社交等高级功能**

#### 步骤13：副本战斗系统 (5-6天)
- [ ] 实现 `server/core/systems/combat_system.py` - 战斗逻辑
- [ ] 实现副本、怪物、掉落系统
- [ ] 实现战斗界面

#### 步骤14：商城交易系统 (4-5天)
- [ ] 实现 `client/ui/windows/shop_window.py` - 商城界面
- [ ] 实现官方商城和玩家交易所
- [ ] 实现交易安全机制

#### 步骤15：实时通信 (3-4天)
- [ ] 实现 `server/api/v1/websocket.py` - WebSocket服务
- [ ] 实现 `client/network/websocket_client.py` - WebSocket客户端
- [ ] 实现 `client/ui/widgets/chat_widget.py` - 聊天功能

### 第五阶段：优化完善 (1-2周)
**目标：性能优化、UI美化、测试完善**

#### 步骤16：界面美化 (3-4天)
- [ ] 设计和实现QSS样式表
- [ ] 添加图标、背景等美术资源
- [ ] 优化界面布局和用户体验

#### 步骤17：性能优化和测试 (3-4天)
- [ ] 编写单元测试
- [ ] 性能优化和内存管理
- [ ] 修复bug和完善功能

## 开发环境准备

### 必需软件
- Python 3.9+
- PyQt6
- PostgreSQL 或 SQLite
- Git

### 开发工具推荐
- IDE: PyCharm 或 VSCode
- 数据库管理: pgAdmin 或 DB Browser for SQLite
- API测试: Postman 或 Thunder Client

## 项目启动命令

### 安装依赖
```bash
pip install -r requirements.txt
```

### 启动服务端
```bash
cd server
python main.py
```

### 启动客户端
```bash
cd client
python main.py
```

## 注意事项

1. **数据库迁移**: 使用Alembic管理数据库版本
2. **代码规范**: 使用Black格式化代码，Flake8检查代码质量
3. **测试驱动**: 每个功能模块都要编写对应的测试用例
4. **版本控制**: 每完成一个步骤都要提交代码
5. **文档更新**: 及时更新API文档和使用说明

---

**当前状态**: ✅ 步骤1、步骤2、步骤3、步骤4已完成
